name: Access Environment-Specific Secret

on:
  push:
    branches:
      - main

jobs:
  use-env-secret:
    runs-on: macos-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Check bash scripts
        run: |
          chmod +x ./start_appium_env.sh
          ./start_appium_env.sh
        continue-on-error: true

      - name: Setup tmate session
        run: |
          brew install tmate

          # Táº¡o session tmate má»›i (detached)
          tmate -S /tmp/tmate.sock new-session -d
          tmate -S /tmp/tmate.sock wait tmate-ready

          # Láº¥y thÃ´ng tin káº¿t ná»‘i
          echo "âœ… SSH connection string:"
          tmate -S /tmp/tmate.sock display -p '#{tmate_ssh}'

          echo "ğŸŒ Web connection (read-only):"
          tmate -S /tmp/tmate.sock display -p '#{tmate_web}'

          echo "ğŸ•’ Session is active. Leave this running until you're done debugging."

          # Giá»¯ session sá»‘ng
          while true; do sleep 30; done

