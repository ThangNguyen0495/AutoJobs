name: Access Environment-Specific Secret

on:
  push:
    branches:
      - main

jobs:
  use-env-secret:
    runs-on: macos-latest

    steps:
      - name: Setup tmate session (debugging - macOS)
        run: |
          brew install tmate
          tmux new-session -d -s debug
          tmux resize-window -t debug -x 200 -y 50
          tmate -S /tmp/tmate.sock new-session -d
          tmate -S /tmp/tmate.sock wait tmate-ready
          
          echo "âœ… SSH connection string:"
          tmate -S /tmp/tmate.sock display -p '#{tmate_ssh}'
          
          echo "ğŸŒ Web connection (read-only):"
          tmate -S /tmp/tmate.sock display -p '#{tmate_web}'
          
          echo "ğŸ•’ Session is active. Leave this running until you're done debugging."
          
          # Keep session alive (use while loop or sleep)
          while true; do sleep 30; done
        continue-on-error: true

